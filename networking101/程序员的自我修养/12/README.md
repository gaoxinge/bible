## 第11章 系统调用与API

### 硬件

```
CPU  内存  显示器  键盘  鼠标  硬盘  网卡
 |     |     |       |     |    |     |
 --------------------------------------  总线
```

- CPU：寄存器
- 内存：内存
- 其他：端口

### 操作系统

```
应用程序
   |
   v
操作系统
   |
   v
 驱动
   |
   v
 硬件
```

### 中断

- 内中断（软件中断）
  - 除0
  - 缺页
  - 系统调用
- 外中断（硬件中断）
  - 可屏蔽中断
  - 不可屏蔽中断
  
### 应用程序到硬件

- 应用程序向操作系统发送read的系统调用
- 操作系统向驱动发送相应的请求
- 驱动通过CPU发送out（in）指令
- 通过硬盘的IO端口进行读写

### 硬件到应用程序

- 键盘，鼠标向CPU发送硬件中断
- CPU通过out（in）指令读取端口数据，并转交给驱动
- 驱动把数据转交给操作系统
- 操作系统把数据转交给相应的应用程序（显示器驱动）

### 参考

- [IO端口与IO内存](https://blog.csdn.net/g_grp/article/details/52431052)
- [鼠标、键盘这些输入设备是把数据直接输入到CPU还是输入到内存？](https://zhidao.baidu.com/question/87086499.html)
- [鼠标和键盘这些输入设备把数据直接输入到CPU还是先输入到内存？](https://www.zhihu.com/question/20824491)
- [鼠标的工作原理是什么？](https://www.zhihu.com/question/31623695)